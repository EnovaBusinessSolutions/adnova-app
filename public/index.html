<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ADNOVA - IA para Marketing de Shopify</title>

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Estilos CSS -->
    <link rel="stylesheet" href="adnova-login.css" />
  </head>

  <body data-page="login"> 
    <div class="login-container">
      <div class="header">
        <h1>ADNOVA AI <span>ü§ñ</span></h1>
        <p>Optimizaci√≥n de marketing con IA para tu tienda Shopify</p>
      </div>

      <h2 class="subtitle">Bienvenido de nuevo</h2>

      <form class="form" id="loginForm">
        <div class="form-group">
          <label class="form-label" for="email">Correo electr√≥nico</label>
          <input
            type="email"
            id="email"
            class="form-input"
            placeholder="tu@correo.com"
            required
          />
        </div>

        <div class="form-group">
          <label class="form-label" for="password">Contrase√±a</label>
          <input
            type="password"
            id="password"
            class="form-input"
            required
          />
        </div>

        <button type="submit" class="btn btn-primary">Iniciar sesi√≥n</button>
      </form>
      <!-- Bot√≥n Registrarse -->
<div class="register-wrapper">
 <button onclick="window.location.href='register.html'" class="btn btn-secondary">Registrarse</button>
</div>

      <div class="divider">
        <span class="divider-text">CONTIN√öA CON</span>
      </div>

      <div class="social-buttons">
        <button class="btn btn-outline">
          <img src="https://img.icons8.com/color/20/google-logo.png" alt="Google" />
          Google
        </button>
        <button class="btn btn-outline">
          <img src="https://img.icons8.com/color/20/windows-10.png" alt="Microsoft" />
          Microsoft
        </button>
      </div>
      <p class="forgot-password">¬øOlvidaste tu contrase√±a? <a href="#" class="recovery-link">Recup√©rala aqu√≠</a></p>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        localStorage.removeItem('onboardingCompletado');
        const form = document.querySelector('form');
        form.addEventListener('submit', async function (e) {
  e.preventDefault();

  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;

  const submitButton = form.querySelector('button[type="submit"]');
  const originalText = submitButton.innerText;
  submitButton.innerText = 'Procesando...';
  submitButton.disabled = true;

  try {
    const res = await fetch('/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();

    if (data.success && data.redirect) {
      localStorage.setItem('userEmail', email); // Guarda el correo
      window.location.href = data.redirect;     // Redirige a onboarding o dashboard
    } else {
      alert(data.message || 'Credenciales incorrectas');
    }
  } catch (err) {
    console.error('Login error:', err);
    alert('‚ùå Error al conectar con el servidor');
  } finally {
    submitButton.innerText = originalText;
    submitButton.disabled = false;
  }
});

        const socialButtons = document.querySelectorAll('.social-buttons .btn');
        socialButtons.forEach((button) => {
          button.addEventListener('click', function () {
            const provider = this.innerText.trim();
            const allButtons = document.querySelectorAll('.btn');
            allButtons.forEach((btn) => (btn.disabled = true));

            setTimeout(() => {
              allButtons.forEach((btn) => (btn.disabled = false));
              alert(`Iniciado sesi√≥n con ${provider} correctamente.`);
            }, 1500);
          });
        });
      });
    </script><script src='script.js' defer></script></body>
</html>
