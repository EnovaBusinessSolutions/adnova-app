<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Onboarding - Adray</title>

  <!-- CSS principal (ruta absoluta para NO fallar seg√∫n d√≥nde abras la p√°gina) -->
  <link rel="stylesheet" href="/onboarding.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />

  <!-- ‚úÖ Fixes de viewport/scroll SOLO para onboarding4 -->
  <style>
    html, body { height: 100%; }

    /* Evita scroll global/whitespace */
    body[data-page="onboarding4"]{
      overflow: hidden;
      /* iOS safe area (si aplica) */
      padding-bottom: env(safe-area-inset-bottom);
    }

    /* El contenedor usa viewport moderno en m√≥viles */
    body[data-page="onboarding4"] .onboarding-container{
      min-height: 100vh;
      min-height: 100svh; /* safari */
      min-height: 100dvh; /* chrome moderno */
    }

    /* El panel derecho scrollea */
    body[data-page="onboarding4"] .content-panel{
      overflow-y: auto;
      overflow-x: hidden;
      height: 100%;
      -webkit-overflow-scrolling: touch;
    }

    /* Firefox */
    body[data-page="onboarding4"] .content-panel{
      scrollbar-width: thin;
      scrollbar-color: #2d2340 #05040a;
    }

    /* WebKit */
    body[data-page="onboarding4"] .content-panel::-webkit-scrollbar{ width: 10px; }
    body[data-page="onboarding4"] .content-panel::-webkit-scrollbar-track{ background:#05040a; }
    body[data-page="onboarding4"] .content-panel::-webkit-scrollbar-thumb{
      background:#2d2340;
      border-radius:999px;
      border:2px solid #05040a;
    }
    body[data-page="onboarding4"] .content-panel::-webkit-scrollbar-thumb:hover{ background:#4b3c75; }

    /* En pantallas bajitas, evita que ‚Äúcorte‚Äù contenido */
    @media (max-height: 760px){
      body[data-page="onboarding4"] .content-panel{
        justify-content: flex-start;
      }
      body[data-page="onboarding4"] .ready-content{
        padding-bottom: 28px;
      }
    }

    /* Micro-mejora m√≥vil: que el CTA no quede pegado */
    @media (max-width: 600px){
      body[data-page="onboarding4"] .bottom-actions{
        padding-bottom: 8px;
      }
      #go-to-dashboard-final{
        width: 100%;
      }
    }
  </style>

  <!-- ===================== PIXELES / TRACKING ===================== -->

  <!-- Google tag (gtag.js) - GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7FR1P31TK3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7FR1P31TK3');
  </script>

  <!-- Meta Pixel Code -->
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '822068647105181');
    fbq('track', 'PageView');
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y)
    })(window, document, "clarity", "script", "ugeg5ymvp5");
  </script>

  <!-- ===================== INTERCOM (E2E) ===================== -->
  <script>
    // ‚úÖ Config m√≠nima (safe). USER_ID_REAL lo reemplaza tu backend igual que en otros steps.
    window.intercomSettings = {
      app_id: "sqexnuzh",
      page: "onboarding_step_4",
      step: 4,
      custom_attributes: {
        onboarding_step: 4,
        onboarding_page: "onboarding_step_4"
      }
    };

    (function () {
      var w = window;
      var ic = w.Intercom;
      if (typeof ic === "function") {
        ic("reattach_activator");
        ic("update", w.intercomSettings);
      } else {
        var d = document;
        var i = function () { i.c(arguments); };
        i.q = [];
        i.c = function (args) { i.q.push(args); };
        w.Intercom = i;

        function l() {
          var s = d.createElement("script");
          s.type = "text/javascript";
          s.async = true;
          s.src = "https://widget.intercom.io/widget/sqexnuzh";
          var x = d.getElementsByTagName("script")[0];
          x.parentNode.insertBefore(s, x);
        }

        if (d.readyState === "complete") l();
        else if (w.attachEvent) w.attachEvent("onload", l);
        else w.addEventListener("load", l, false);
      }
    })();
  </script>
  <!-- =========================================================== -->

</head>

<body data-page="onboarding4" data-user-id="USER_ID_REAL">
  <!-- Meta Pixel (noscript) -->
  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=822068647105181&ev=PageView&noscript=1" />
  </noscript>

  <div class="onboarding-container">

    <aside class="sidebar" aria-label="Progreso de onboarding">
      <div class="logo">
        <h1>Adray<span class="emoji"></span></h1>
      </div>

      <nav class="steps">
        <div class="step" data-step="1">
          <div class="step-indicator"><span class="step-number">1</span></div>
          <div class="step-text">
            <h3>Conecta tus cuentas</h3>
            <p>Agrega tu tienda y cuentas de marketing</p>
          </div>
        </div>

        <div class="step" data-step="2">
          <div class="step-indicator"><span class="step-number">2</span></div>
          <div class="step-text">
            <h3>Revisar permisos</h3>
            <p>Verifica y acepta los permisos requeridos</p>
          </div>
        </div>

        <div class="step" data-step="3">
          <div class="step-indicator"><span class="step-number">3</span></div>
          <div class="step-text">
            <h3>An√°lisis</h3>
            <p>Analizaremos los datos de tu tienda</p>
          </div>
        </div>

        <div class="step active" data-step="4" aria-current="step">
          <div class="step-indicator"><span class="step-number">4</span></div>
          <div class="step-text">
            <h3>Dashboard</h3>
            <p>Consulta los resultados de optimizaci√≥n</p>
          </div>
        </div>
      </nav>
    </aside>

    <div class="main-content">
      <main class="content-panel" role="main">
        <div class="ready-content" id="ready-content">
          <h2>¬°Listo para comenzar!</h2>

          <p class="panel-description">
            Tu cuenta de Adray est√° completamente configurada y lista para usar.
          </p>

          <div class="success-message" aria-live="polite">
            <h3>üéâ ¬°Configuraci√≥n completada!</h3>
            <p>
              Tus cuentas ya est√°n conectadas y todo est√° preparado para el an√°lisis y la optimizaci√≥n.
            </p>
          </div>

          <div class="features-summary">
            <div class="feature-item">
              <span class="feature-icon">üìä</span>
              <div class="feature-text">
                <h3>Dashboard</h3>
                <p>Consulta el rendimiento general de tus campa√±as y plataformas de marketing.</p>
              </div>
            </div>

            <div class="feature-item">
              <span class="feature-icon">üìù</span>
              <div class="feature-text">
                <h3>Auditor√≠as inteligentes</h3>
                <p>Revisa el informe detallado generado por la IA.</p>
              </div>
            </div>

            <div class="feature-item">
              <span class="feature-icon">üéØ</span>
              <div class="feature-text">
                <h3>Verificador de seguimiento</h3>
                <p>Comprueba que tus p√≠xeles y conversiones est√©n enviando eventos correctamente.</p>
              </div>
            </div>
          </div>

          <div class="bottom-actions">
            <button
              class="btn-gradient go-to-dashboard-final"
              id="go-to-dashboard-final"
              type="button"
              data-next="dashboard"
            >
              Comenzar
            </button>
          </div>
        </div>
      </main>
    </div>

  </div>

  <!-- JS (ruta absoluta + defer para asegurar DOM listo) -->
  <script src="/js/onboarding4.js" defer></script>
</body>
</html>
